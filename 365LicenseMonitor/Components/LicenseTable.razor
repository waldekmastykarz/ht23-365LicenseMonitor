@using Microsoft.AspNetCore.Authorization
@using Microsoft.Graph

@attribute [Authorize]

@inject GraphServiceClient GraphClient

<MudTable Items="@LicenseList" Dense="true" Hover="false" Bordered="true" Striped="true" FixedHeader="true" RowsPerPage="25" Breakpoint="Breakpoint.Sm" Loading="@_loading" LoadingProgressColor="Color.Info" Filter="new Func<License,bool>(FilterFunc1)">
        <ToolBarContent>
            <MudText Typo="Typo.h6">License table</MudText>
            <MudSpacer />
            <MudTextField @bind-Value="searchString1" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
        </ToolBarContent>
        <HeaderContent>
        <MudTh><MudTableSortLabel SortBy="new Func<License, object>(x=>x.ProductName)">ProductName</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<License, object>(x=>x.PrepaidUnits)">PrepaidUnits</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<License, object>(x=>x.ConsumedUnits)">ConsumedUnits</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<License, object>(x=>x.UnusedUnits)">UnusedUnits</MudTableSortLabel></MudTh>
    </HeaderContent>
        <RowTemplate>
        <MudTd DataLabel="ProductName">@context.ProductName</MudTd>
        <MudTd DataLabel="PrepaidUnits">@context.PrepaidUnits</MudTd>
        <MudTd DataLabel="ConsumedUnits">@context.ConsumedUnits</MudTd>
        <MudTd DataLabel="UnusedUnits">@context.UnusedUnits</MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>

